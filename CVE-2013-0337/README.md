##CloudPassage Halo Policy: CVE-2013-0337 - CVE-2013-0337 - World-readable permissions in nginx log files

###About
On Sunday, October 27th, 2013 the <a href="http://nvd.nist.gov/home.cfm" target="new">US-CERT National Vulnerability Database (NVD)</a> released <a href="http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-0337" target="new">CVE-2013-0337</a> based on reports from an October 6th, 2013 <a href="http://gentoo.org" target="new">Gentoo Linux</a> Security Advisory (<a href="http://www.gentoo.org/security/en/glsa/glsa-201310-04.xml" target="new">GLSA 201310-04 / nginx</a>) and an October 7th, 2013 <a href="http://secunia.com/" target="new">Secunia</a> Advisory (<a href="http://secunia.com/advisories/55181" target="new">SA55181</a>). From the CVE details:

> The default configuration of nginx, possibly 1.3.13 and earlier, uses world-readable permissions for the (1) access.log and (2) error.log files, which allows local users to obtain sensitive information by reading the files.

Secunia, NIST, and the folks at Gentoo claim that this CVE is address in www-servers/nginx 1.4.1-r2 and later. Through investigations of various non-Gentoo Linux distributions, however, it appears that this issue, though perhaps resolved on Gentoo, persist for both nginx installations from source and using native package mangement applications - such as 'yum' and 'apt-get'. 

According to an Openwall mailing list, <a href="http://www.openwall.com/lists/oss-security/2013/02/24/1" target="new">one user had reached out to the nginx team</a> via email in Q1-2013. The response received, from Maxim Dounin, was as follows:

> We are fine with default permissions used for log files. If in a particular configuration stricter permissions are required, this may be done either by creating appropriate log files with needed permissions, or by restricting access to a directory with log files.

The testing of various server installations by <a href="https://twitter.com/dshaw_" target="new">David Shaw</a>, CTO at <a href="www.redspin.com" target="new">Redspin</a>, and <a href="https://twitter.com/andrewsmhay" target="new">Andrew Hay</a>, Director of Applied Security Research at <a href="http://www.cloudpassage.com">CloudPassage Inc.</a>, resulted in a much wider affected version count than disclosed in the CVE.

More information on the CVE can be found at <a href="http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-0337" target="new">http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-0337</a>.

####Affected and tested versions
* nginx-1.5.6 (source) 
* nginx-1.4.3 (source)
* nginx-1.2.9 (source)
* nginx.x86_64 1:1.4.2-1.12.amzn1 (Amazon Linux AMI) 
* nginx-full (1.4.1-3ubuntu1) (ubuntu-saucy-13.10-amd64-server-20131015)

Note: Gist located here with discovery information: <a href="https://gist.github.com/davidshaw/ed621da08aa9671fdcb7" target="new">https://gist.github.com/davidshaw/ed621da08aa9671fdcb7</a>. It is entirely likely that many more combinations of operating system specific packages are suceptible to the issues in the CVE.

####Affected versions
* nginx-1.5.6 and earlier (and likely later)

###CloudPassage Policy

To help users detect if their nginx access.log and error.log files are suceptible to unintentional information disclosure, the <b>CVE-2013-0337 - CVE-2013-0337 - World-readable permissions in nginx log files</b> configuration policy was created.

###Rules and Checks
It should be noted that the following rules and checks could serve as a potential indicator of compromise (IOC). That being said, an alert on a true possitive on an individual check will likely not serve as the sole indicator of vulnerability, but it should still be investigated.

<b>Software Configuration > World-readable permissions in nginx log files</b>
<ul><li>Contains a File ACL check to see if the access.log and error.log files are configured without world-readable permissions (e.g. 644) in favor of more restrictive permissions (640).</li></ul>

###Installation

To begin using the <b>CVE-2013-0337 - World-readable permissions in nginx log files</b> configuration policy, download the cve-2013-0337-world-readable-permissions-in-nginx-log-files.policy.json file to your local workstation, log into your CloudPassage Halo Portal account, and import the policy as a Configuration Policy.

###Contact

To provide any feedback or ask any questions please reach out to Andrew Hay on Twitter at <a href="http://twitter.com/andrewsmhay" target="new">@andrewsmhay</a>.
