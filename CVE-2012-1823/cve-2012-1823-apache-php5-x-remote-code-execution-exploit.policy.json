{"policy":{"name":"CVE-2012-1823 - Apache / PHP5.x Remote Code Execution Exploit","description":"This rule alerts if a server's PHP configuration is suceptible to the remote execution exploit reported on Tuesday, October 29th, 2013.\r\n\r\nREF: http://www.exploit-db.com/exploits/29290/","platform":"linux","url":"https://api.cloudpassage.com/v1/policies/da7fd74023060131ce113c764e108057","id":"da7fd74023060131ce113c764e108057","used_by":[{"id":"e3b83fb0230a0131ce123c764e108057","name":"CVE-2012-1823"}],"rules":[{"active":true,"alert":true,"comment":"[Affected and tested versions]\r\nPHP 5.3.10\r\nPHP 5.3.8-1\r\nPHP 5.3.6-13\r\nPHP 5.3.3\r\nPHP 5.2.17\r\nPHP 5.2.11\r\nPHP 5.2.6-3\r\nPHP 5.2.6+lenny16 with Suhosin-Patch\r\n\r\n[Affected versions]\r\nPHP prior to 5.3.12\r\nPHP prior to 5.4.2\r\n\r\n[Unaffected versions]\r\nPHP 4 - getopt parser unexploitable\r\nPHP 5.3.12 and up\r\nPHP 5.4.2 and up\r\nUnaffected versions are patched by CVE-2012-1823.\r\n\r\nFor more information visit: http://www.exploit-db.com/exploits/29290/","critical":false,"log":true,"name":"Vulnerable PHP version possibly installed","taxonomy":"system_configuration","checks":[{"object_type":"file_string_presence","active":true,"exportable":true,"suggestion":"","files":"/var/log/dpkg.log","present":false,"patterns":"status installed php5 5.3.10"},{"object_type":"file_string_presence","active":true,"exportable":true,"suggestion":"","files":"/var/log/dpkg.log","present":false,"patterns":"status installed php5 5.3.8"},{"object_type":"file_string_presence","active":true,"exportable":true,"suggestion":"","files":"/var/log/dpkg.log","present":false,"patterns":"status installed php5 5.3.6-13"},{"object_type":"file_string_presence","active":true,"exportable":true,"suggestion":"","files":"/var/log/dpkg.log","present":false,"patterns":"status installed php5 5.3.3"},{"object_type":"file_string_presence","active":true,"exportable":true,"suggestion":"","files":"/var/log/dpkg.log","present":false,"patterns":"status installed php5 5.2.17"},{"object_type":"file_string_presence","active":true,"exportable":true,"suggestion":"","files":"/var/log/dpkg.log","present":false,"patterns":"status installed php5 5.2.17"},{"object_type":"file_string_presence","active":true,"exportable":true,"suggestion":"","files":"/var/log/dpkg.log","present":false,"patterns":"status installed php5 5.2.11"},{"object_type":"file_string_presence","active":true,"exportable":true,"suggestion":"","files":"/var/log/dpkg.log","present":false,"patterns":"status installed php5 5.2.6-3"},{"object_type":"file_string_presence","active":true,"exportable":true,"suggestion":"","files":"/var/log/dpkg.log","present":false,"patterns":"status installed php5 5.2.6+lenny16"}]},{"active":true,"alert":false,"comment":"This is a code execution bug in the combination of Apache and PHP.\r\n\r\nFor more information please see the following post: http://www.exploit-db.com/exploits/29290/","critical":false,"log":true,"name":"cgi.force_redirect","taxonomy":"software_configuration","checks":[{"object_type":"file_string_presence","active":true,"exportable":true,"suggestion":"In the source code file sapi/cgi/cgi_main.c of PHP we can see that the security check is done when the php.ini configuration setting cgi.force_redirect is set and the php.ini configuration setting cgi.redirect_status_env is set to no. This makes it possible to execute the binary bypassing the Security check by setting these two php.ini settings.\r\n\r\nFor more information please see the following post: http://www.exploit-db.com/exploits/29290/","files":"/etc/php5/cli/php.ini,/etc/php5/cgi/php.ini,/etc/php5/apache2/php.ini","present":false,"patterns":"cgi.force_redirect = yes"}]},{"active":true,"alert":true,"comment":"This is a code execution bug in the combination of Apache and PHP.\r\n\r\nFor more information please see the following post: http://www.exploit-db.com/exploits/29290/","critical":true,"log":true,"name":"cgi.redirect_status_env","taxonomy":"software_configuration","checks":[{"object_type":"file_string_presence","active":true,"exportable":true,"suggestion":"In the source code file sapi/cgi/cgi_main.c of PHP we can see that the security check is done when the php.ini configuration setting cgi.force_redirect is set and the php.ini configuration setting cgi.redirect_status_env is set to no. This makes it possible to execute the binary bypassing the Security check by setting these two php.ini settings.\r\n\r\nFor more information please see the following post: http://www.exploit-db.com/exploits/29290/","files":"/etc/php5/cli/php.ini,/etc/php5/cgi/php.ini,/etc/php5/apache2/php.ini","present":false,"patterns":"cgi.redirect_status_env = yes"}]}]}}